---
title: 用规则引擎来做决策
date: 2022-12-25 20:00:00
tags:
- 架构
---

规则引擎是一种嵌入在应用程序中的组件，实现了将业务决策从应用程序代码中分离出来，并使用预定义的语义模块编写业务决策。接受数据输入，解释业务规则，并根据规则做出业务决策。

![规则引擎](//www.fanhaobai.com/2022/12/rule-engine/12805423-37FB-4225-91E3-EC6473BA720C.png)<!--more-->

业务规则是指：设置一个或多个条件，当满足这些条件时会触发一个或多个操作。多个业务规则组成决策树，通常使用 DSL 语言来表述。

## 关键词

* 自动化决策
* 业务规则
* 规则引擎
* 可配置

## 商业价值
### 业务自动化

特定场景可以代替人工自动化决策，标准统一，错误率低。

### 提高研发效率

现所有业务决策逻辑都是通过 if-else、switch 的方式硬编码在业务代码中，都要经过需求->开发->测试->上线的周期，时间长。

### 降低研发成本

功能复用，减少重复开发。

## 解决方案介绍
### 业务风控

通过业务数据分析，可以抽象出用户异常行为的规则：

![风控规则](//www.fanhaobai.com/2022/12/rule-engine/C0C5B489-90D1-4937-A8D8-55459E951ABC.png)

然后，风控系统在判断是否为风险操作时，只需要规则引擎加载并执行风控规则，即可得到结果。
想要提高风控系统的准确性，只需要不断地迭代完善风控规则。

![风控系统](//www.fanhaobai.com/2022/12/rule-engine/C290970F-D33E-49DF-846B-577E62694709.png)

### 运营活动

拿最常见的抽奖和做任务 2 种运营活动来说，都可以将具体活动逻辑抽象为业务规则：
① 抽奖，不同的人&不同的场景对应不同的奖池（中奖概率与奖品集合规则）；
② 做任务，任务领取规则、任务完成指标动态可配（任务规则）；

![运营活动](//www.fanhaobai.com/2022/12/rule-engine/30B59826-F443-4D9A-AC98-42F7E28127D5.png)

### 内容分发

针对某些特定的用户或者某种场景的用户，下发特定的展示内容或者推送短信等触达消息，都可以将这些特定用户的逻辑梳理为内容分发规则。

![内容分发](//www.fanhaobai.com/2022/12/rule-engine/E937E855-8B7C-4B4C-9761-0764D563BE42.png)

## 我们的机会
### 业务场景

只要是有明确业务规则的逻辑，且规则数量较大的场景，都可以运用规则引擎来解决，比如商品推荐、自动审核、内容分发的场景。

* 医生带货推荐商品
特定医生推荐特定商品

* 处方系统前置审核
特定诊断有什么特定审核规则

* 运营活动
特定用户做什么任务领取什么奖励

* A/B test平台
特定用户下发特定内容